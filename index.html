<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Royal School</title>
    <link rel="shortcut icon" href="imagens/logo.ico" type="image/x-icon">
    <link rel="stylesheet" href="css/index.css">
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        function validateForm() {
          let x = document.forms["myForm"]["fname1"].value;
          if (x == "") {
            alert("Name must be filled out");
            return false;
          }
          else{
              alert(x)
          }
        }
        </script>
</head>
<body>
    <header>
        <h1>Tipo de Inscrição</h1>
        <nav>
            <a href="#">Ano Letivo</a>
            <a href="#">Turma</a>
            <a href="#">Nivel</a>
            <a href="#">Aluno</a>
            <a href="#">Enc. Educação</a>
            <a href="#">Inscrição</a>
            <a href="#">Tipo Inscrição</a>
            <a href="#">Desconto</a>
            <a href="#">Mensalidade</a>
        </nav>
    </header>
    <main>
        <section>
            <h2>Criar novo Tipo de Inscrição</h2>
            <form name="formTipoInscricao"  id= "formTipoInscricao" method="post">
                <article>
                    <label for="descritivo">Descrição</label>
                    <input type="text" id="descritivo" name="txtDescritivo">
                </article>
                <article>
                    <label for="valorInscricao">Valor Inscrição Sem Iva</label>
                    <input type="number" id="valorInscricao" name="txtValorInscricao" value= "0.00" min="0.00" step="0.01">
                </article>
                <article>
                    <label for="valorLivro">Valor Livro Sem Iva</label>
                    <input type="number" id="valorLivro" name="txtValorLivro" value= "0.00" min="0.00" step="0.01">
                </article>
                <article>
                    <label for="valorMensalidade">Valor Mensalidade Sem Iva</label>
                    <input type="number" id="valorMensalidade" name="txtValorMensalidade" value= "0.00" min="0.00" step="0.01">
                </article>
                <input type="button" value="Gravar" onclick="validaFormularioTipoIncricao()">
            </form>
        </section>
    </main>
    <footer>
        <img src="imagens/logoFooter.png" alt="Royal School Rodapé">
    </footer>
</body>
</html>

<script>
    function validaFormularioTipoIncricao() {
        var descritivo = document.forms["formTipoInscricao"]["txtDescritivo"].value;
        var valorInscricao = document.forms["formTipoInscricao"]["txtValorInscricao"].value;
        var valorLivro = document.forms["formTipoInscricao"]["txtValorLivro"].value;
        var valorMensalidade = document.forms["formTipoInscricao"]["txtValorMensalidade"].value;
        
        
        if (descritivo == "") {
            faltaCampo("Descritivo");
            document.forms["formTipoInscricao"]["txtDescritivo"].focus();
        }
        else if (valorInscricao == "") {
            faltaCampo("Valor Inscrição");
            document.forms["formTipoInscricao"]["txtValorInscricao"].focus();
        }
        else if(valorLivro == "") {
            faltaCampo("Valor Livro");
            document.forms["formTipoInscricao"]["txtValorLivro"].focus();
        }
        else if(valorMensalidade == "") {
            faltaCampo("Valor Mensalidade");
            document.forms["formTipoInscricao"]["txtValorMensalidade"].focus();
        }
        else{
            guardaCampo(descritivo, valorInscricao, valorLivro, valorMensalidade);
            mostraTipoInscricaoGravar(descritivo, valorInscricao, valorLivro, valorMensalidade);
        }  
    }
    function faltaCampo(campo){
        Swal.fire({
            icon: 'error',
            title: campo,
            text: 'Por favor introduza uma valor válido.',
        })
    }
    function guardaCampo(descritivo, valorInscricao, valorLivro, valorMensalidade){
        Swal.fire({
            title: 'Pretende guardar',
            html: '<div id="txtTabela">Este texto vai ser substituido pela tabela</div>',
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Sim, gravar!'
        }).then((result) => {
            if (result.isConfirmed) {
                Swal.fire(
                'Gravar!',
                'O seu registo foi guardado com sucesso!',
                'success'
                )
            }
            limpaDados();
        })
    }
    function mostraTipoInscricaoGravar(descritivo, valorInscricao, valorLivro, valorMensalidade) {
        const xhttp = new XMLHttpRequest();
        xhttp.onload = function() {
            document.getElementById("txtTabela").innerHTML = this.responseText;
        }
        xhttp.open("GET", "getDadosFormularioTipoInscricao.php?descritivo="+descritivo+"&valorInscricao="+valorInscricao+"&valorLivro="+valorLivro+"&valorMensalidade="+valorMensalidade, true);
        xhttp.setRequestHeader("Content-Type", "text/plain;charset=UTF-8");
        xhttp.send();

        console.log (xhttp);
    }
    function limpaDados(){
        document.getElementById("formTipoInscricao").reset();
    }

</script>
